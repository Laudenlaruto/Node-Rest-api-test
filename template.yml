AWSTemplateFormatVersion: 2010-09-09
Transform:
- AWS::Serverless-2016-10-31
- AWS::CodeStar

Parameters:
  ProjectId:
    Type: String
    Description: AWS CodeStar projectID used to associate new resources to team members

Resources:
  Notes:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      Runtime: nodejs4.3
      Events:
          create:
            handler: handler.create # point to exported create function in handler.js
            events:
              - http:
                  path: notes # path will be domain.name.com/dev/notes
                  method: post
                  cors: true
            getOne:
              handler: handler.getOne
              events:
                - http:
                    path: notes/{id} # path will be domain.name.com/dev/notes/1
                    method: get
                    cors: true
            getAll:
              handler: handler.getAll # path will be domain.name.com/dev/notes
              events:
               - http:
                   path: notes
                   method: get
                   cors: true
            update:
              handler: handler.update # path will be domain.name.com/dev/notes/1
              events:
               - http:
                   path: notes/{id}
                   method: put
                   cors: true
            delete:
              handler: handler.delete
              events:
               - http:
                   path: notes/{id} # path will be domain.name.com/dev/notes/1
                   cors: true
                   method: delete
                   
  HelloWorld:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      Runtime: nodejs4.3
      Role:
        Fn::ImportValue:
          !Join ['-', [!Ref 'ProjectId', !Ref 'AWS::Region', 'LambdaTrustRole']]
      Events:
        GetEvent:
          Type: Api
          Properties:
            Path: /
            Method: get
        PostEvent:
          Type: Api
          Properties:
            Path: /
            Method: post
